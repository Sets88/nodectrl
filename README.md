nodectrl
========

## Описание
В вашей сети куча сетевого оборудования, поставив последний свич вы забыли где стоит первый, тогда мы идем к вам!

Приложение основанное на Flask + SQLAlchemy написано специально для того чтобы каталогизировать имеющееся в сети сетевое оборудование.

Так же можно проверить работает ли оборудование в данный момент.

И это еще далеко не все что может делать это приложение. 

![Screenshot](/img/nodectrl.png)

## Установка
В Ubuntu все устанавливается очень просто:

    sudo apt-get -y install git python-flask python-sqlalchemy nmap libsnmp-python python-ipaddr
    git clone https://github.com/Sets88/nodectrl.git
    cd nodectrl
    python web.py

Такой вариант неплох чтобы пощупать приложение, но для работы советую все-же восползоваться uwsgi + Nginx или mod_wsgi + Apache


## Настройка
Для настройки используйте встроенный менеджер настройки: Свич -> Настройка, где желательно сразу добавить пользователя, указать ключ(лучше всего сгенерировать, этот ключ участвует при шифровании пароля)

Можно вместо sqlite использовать mysql.

Можете добавить необходимые вам категории и нужные подсети в категориях.

Так же можно добавить необходимые дополнительные ссылки, которые будут отображаться в верхней панели.

Не забудьте после добавления пользователей изменить привилегии пользователей, конкретно измените привилегию "settings_edit", которая дает доступ к настройкам и по умолчанию разрешена всем, просто укажите там логин администратора или администраторов через запятую, например:
vasya, root, admin
Что разрешит пользователям vasya, root и admin изменять настройки (естественно при наличии этих пользователей)


Внимание, когда будете строить иерархию свичей, не забывайте в названии свичей, которые умеют отвечать по SNMP, вначале ставить "(v)" (без ковычек), например такое название ничего: (v) Ленина 90 (DES-1228).

Это сделано для того чтобы приложение знал у кого можно спросить по SNMP о том, на каком порту у него находится требуемый мак адрес, что используется в автоматическом перемещении свичей и поиске по MAC адресу.

Думаю что это будет работать только на Dlink свичах.

## Дополнительные возможности

### Флаг "Внимание"

Бывают случаи когда нужно знать, что какой либо свич отключался, например ночью(для оповещения использую внешнее ПО), достаточно заставить стороннее ПО перейти по нужной вам ссылке и будет установлен флаг.

Делается это так:

1. Заходим в Свич -> Настройки
2. Находим поле "Сгенерировать хэш..." Вписываем туда IP адрес машины которая должна иметь доступ к установке флагами
3. Жмем генерировать
4. Теперь мы получили хэш, копируем его

URL будет такой формы:

	http://nashnodectrl:port/api/setflag/{IP}/{Status}/{HASH}/

Например:

	http://192.168.1.1:5000/api/setflag/10.90.90.176/1/8a3c2b1d5d8d2bbb5e190e0e9bc39ce01f981eaa/

установит флаг 1 элементу с IP 10.90.90.176, на котором будет теперь отображаться "!"

### Где же этот MAC

Мне необходимо узнать на каком свиче находится нужный мне MAC адрес

URL будет такой формы:

	http://nashnodectrl:port/api/getnodebymac/{MAC}/{HASH}/

Например:

	http://192.168.1.1:5000/api/getnodebymac/00:e0:4c:11:5a:2c/8a3c2b1d5d8d2bbb5e190e0e9bc39ce01f981eaa/

Вернет имя свича на котором находится этот MAC адрес
